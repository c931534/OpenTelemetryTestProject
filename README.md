# OpenTelemetry .NET Demo

é€™æ˜¯ä¸€å€‹ä½¿ç”¨ OpenTelemetry 1.10.0 çš„ .NET å¾®æœå‹™æ¶æ§‹æ¼”ç¤ºå°ˆæ¡ˆï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ä¸åŒæœå‹™é–“æ”¶é›†å’Œå‚³é telemetry æ•¸æ“šã€‚

## ğŸ—ï¸ æ¶æ§‹æ¦‚è¿°

### æœå‹™æ¶æ§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚    Backend      â”‚
â”‚   Service A     â”‚    â”‚   Service E     â”‚
â”‚  (æœƒå“¡æœå‹™)      â”‚    â”‚  (ç®¡ç†å“¡æœå‹™)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚
          â”‚                      â”‚
          â–¼                      â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           Business Services         â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚Service Bâ”‚ â”‚Service Câ”‚ â”‚Service Dâ”‚ â”‚
    â”‚  â”‚Promotionâ”‚ â”‚Payment  â”‚ â”‚Third-   â”‚ â”‚
    â”‚  â”‚(è¡ŒéŠ·)   â”‚ â”‚(é‡‘æµ)   â”‚ â”‚party    â”‚ â”‚
    â”‚  â”‚         â”‚ â”‚         â”‚ â”‚(ç¬¬ä¸‰æ–¹)  â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœå‹™è§’è‰²èªªæ˜

#### ä¸Šå±¤æœå‹™ (Frontend/Backend)
- **Service A (å‰å°æœå‹™)**: æœƒå“¡ç›¸é—œçš„ API æœå‹™ï¼Œæä¾›æœƒå“¡åŠŸèƒ½ä»‹é¢
- **Service E (å¾Œå°æœå‹™)**: å…§éƒ¨ç®¡ç†äººå“¡çš„ API æœå‹™ï¼Œæä¾›ç®¡ç†åŠŸèƒ½ä»‹é¢

#### ä¸‹å±¤æœå‹™ (Business Services)
- **Service B (Promotion æœå‹™)**: è¡ŒéŠ·æ´»å‹•ã€å„ªæƒ åˆ¸ã€æŠ˜æ‰£ç­‰æœå‹™
- **Service C (Payment æœå‹™)**: é‡‘æµã€æ”¯ä»˜ã€é€€æ¬¾ç­‰æœå‹™  
- **Service D (Third-party æœå‹™)**: å¤–éƒ¨æ•´åˆæœå‹™ï¼Œå¦‚ç°¡è¨Šã€éƒµä»¶ç­‰

### æœå‹™èª¿ç”¨æµç¨‹
1. **å‰å°æµç¨‹**: æœƒå“¡é€é Service A èª¿ç”¨ä¸‹å±¤æ¥­å‹™æœå‹™
2. **å¾Œå°æµç¨‹**: ç®¡ç†å“¡é€é Service E èª¿ç”¨ä¸‹å±¤æ¥­å‹™æœå‹™é€²è¡Œç®¡ç†
3. **æ¥­å‹™æœå‹™**: ä¸‹å±¤æœå‹™è™•ç†å…·é«”æ¥­å‹™é‚è¼¯ï¼Œä¸¦å›å‚³çµæœ

## ğŸ¯ å°ˆæ¡ˆ Demo ç›®æ¨™

### 1. OpenTelemetry æ•´åˆå±•ç¤º
- å±•ç¤ºå¦‚ä½•åœ¨ .NET å¾®æœå‹™ä¸­æ•´åˆ OpenTelemetry
- æ¼”ç¤º Metricsã€Traces å’Œ Logs çš„æ”¶é›†
- å±•ç¤ºæœå‹™é–“èª¿ç”¨çš„è¿½è¹¤èƒ½åŠ›

### 2. å¾®æœå‹™æ¶æ§‹ç›£æ§
- å±•ç¤ºå¤šå±¤æœå‹™æ¶æ§‹çš„ç›£æ§æ–¹å¼
- æ¼”ç¤ºå‰å°å’Œå¾Œå°æœå‹™çš„ä¸åŒç›£æ§ç¶­åº¦
- å±•ç¤ºæ¥­å‹™æœå‹™çš„æ€§èƒ½ç›£æ§

### 3. å¯¦éš›æ¥­å‹™å ´æ™¯æ¨¡æ“¬
- æ¨¡æ“¬çœŸå¯¦çš„æœƒå“¡å’Œç®¡ç†å“¡æ“ä½œå ´æ™¯
- å±•ç¤ºä¸åŒæœå‹™é¡å‹çš„ç›£æ§éœ€æ±‚
- æ¼”ç¤ºæœå‹™å»¶é²å’ŒéŒ¯èª¤çš„ç›£æ§

### 4. ç›£æ§æ•¸æ“šåˆ†æ
- æä¾› Prometheus å’Œ Grafana çš„ç›£æ§é¢æ¿
- å±•ç¤ºä¸åŒç¶­åº¦çš„ metrics åˆ†æ
- æ¼”ç¤ºæœå‹™ä¾è³´é—œä¿‚çš„å¯è¦–åŒ–

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å‰ç½®éœ€æ±‚
- Docker å’Œ Docker Compose
- .NET 8.0 SDK

### å•Ÿå‹•æœå‹™
```bash
# å•Ÿå‹•æ‰€æœ‰æœå‹™
docker-compose up -d

# æŸ¥çœ‹æœå‹™ç‹€æ…‹
docker-compose ps
```

### æ¸¬è©¦ API
```bash
# å‰å°æœå‹™æ¸¬è©¦
curl http://localhost:5001/api/member/promotion
curl http://localhost:5001/api/member/payment
curl http://localhost:5001/api/member/thirdparty
curl http://localhost:5001/api/member/all-services

# å¾Œå°æœå‹™æ¸¬è©¦
curl http://localhost:5005/api/admin/promotion-management
curl http://localhost:5005/api/admin/payment-management
curl http://localhost:5005/api/admin/thirdparty-management
curl http://localhost:5005/api/admin/all-management
```

## ğŸ“Š ç›£æ§å’ŒæŒ‡æ¨™

### Metrics å‘½åè¦ç¯„
- **å‰å°æœå‹™**: `frontend_*_requests_total`, `frontend_*_error_count`
- **å¾Œå°æœå‹™**: `backend_*_management_requests_total`, `backend_*_management_error_count`
- **æ¥­å‹™æœå‹™**: `*_service_requests_total`, `*_service_delay_count`

### ç›£æ§ç¶­åº¦
- `service_type`: æœå‹™é¡å‹ (frontend, backend, promotion, payment, thirdparty)
- `request_source`: è«‹æ±‚ä¾†æº (member, admin)
- `endpoint`: API ç«¯é»
- `error_type`: éŒ¯èª¤é¡å‹

### ç›£æ§å·¥å…·
- **OpenTelemetry Collector**: æ”¶é›†å’Œè™•ç† telemetry æ•¸æ“š
- **Prometheus**: å­˜å„²å’ŒæŸ¥è©¢ metrics
- **Grafana**: æ•¸æ“šå¯è¦–åŒ–å’Œç›£æ§é¢æ¿

## ğŸ”§ é…ç½®èªªæ˜

### OpenTelemetry é…ç½®
- ä½¿ç”¨ OTLP å”è­°å‚³è¼¸æ•¸æ“š
- æ”¯æ´ Metricsã€Traces å’Œ Logs
- å¯é…ç½®çš„æ¡æ¨£ç‡å’Œç·©è¡å€å¤§å°

### æœå‹™é…ç½®
- æ¯å€‹æœå‹™éƒ½æœ‰ç¨ç«‹çš„ OpenTelemetry é…ç½®
- æ”¯æ´è‡ªå®šç¾© metrics å’Œ traces
- å¯é…ç½®çš„æœå‹™åç¨±å’Œç‰ˆæœ¬

## ğŸ“ å°ˆæ¡ˆçµæ§‹
```
otel-dotnet-demo-otel-1.10.0/
â”œâ”€â”€ service-a/          # å‰å°æœå‹™ (æœƒå“¡)
â”œâ”€â”€ service-e/          # å¾Œå°æœå‹™ (ç®¡ç†å“¡)
â”œâ”€â”€ service-b/          # Promotion æœå‹™
â”œâ”€â”€ service-c/          # Payment æœå‹™
â”œâ”€â”€ service-d/          # Third-party æœå‹™
â”œâ”€â”€ otel-collector-config.yaml  # OpenTelemetry é…ç½®
â”œâ”€â”€ prometheus.yml      # Prometheus é…ç½®
â””â”€â”€ docker-compose.yml  # Docker ç·¨æ’é…ç½®
```

## ğŸ‰ ç¸½çµ

é€™å€‹å°ˆæ¡ˆå±•ç¤ºäº†å¦‚ä½•åœ¨ .NET å¾®æœå‹™æ¶æ§‹ä¸­æ•´åˆ OpenTelemetryï¼Œæä¾›å®Œæ•´çš„å¯è§€æ¸¬æ€§è§£æ±ºæ–¹æ¡ˆã€‚é€šéå¯¦éš›çš„æ¥­å‹™å ´æ™¯æ¨¡æ“¬ï¼Œé–‹ç™¼è€…å’Œé‹ç¶­äººå“¡å¯ä»¥æ›´å¥½åœ°ç†è§£å¾®æœå‹™ç›£æ§çš„é‡è¦æ€§å’Œå¯¦ä½œæ–¹å¼ã€‚
